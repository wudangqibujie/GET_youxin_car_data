<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ESP9WBipoQkGmhR1RP5878A7sk71zX4M"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
		ul,li{list-style: none;margin:0;padding:0;float:left;}
		html{height:100%}
		body{height:100%;margin:0px;padding:0px;font-family:"微软雅黑";}
		#container{height:500px;width:100%;}
		#r-result{width:100%;}
    </style>
</head>
<body>
	<div id="container"></div>
	<div id="r-result">
		<input type="button"  onclick="openHeatmap();" value="显示热力图"/><input type="button"  onclick="closeHeatmap();" value="关闭热力图"/>
	</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例

    var point = new BMap.Point(116.418261, 39.921984);
    map.centerAndZoom(point, 15);             // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放

    var points =[
    {"lng":117.28269909168304,"lat":31.86694226068694,"count":84},
    {"lng":117.0587387721073,"lat":30.537897817381097,"count":0},
    {"lng":117.35707986587582,"lat":32.92949890669797,"count":83},
    {"lng":115.82093225904637,"lat":32.90121133056961,"count":0},
    {"lng":116.79144742863005,"lat":33.96002330536412,"count":0},
    {"lng":117.01863886329463,"lat":32.64281182374795,"count":83},
    {"lng":116.50525268298414,"lat":31.75555835519844,"count":83},
    {"lng":118.38410842322828,"lat":31.36601978754301,"count":83},
    {"lng":118.32457035097686,"lat":32.31735059538377,"count":0},
    {"lng":116.9886924118307,"lat":33.63677238578078,"count":83},
    {"lng":116.39564503787867,"lat":39.92998577808024,"count":43},
    {"lng":119.33022110712668,"lat":26.04712549657293,"count":89},
    {"lng":118.10388604566381,"lat":24.489230612469232,"count":23},
    {"lng":117.01799673877318,"lat":25.07868543351518,"count":84},
    {"lng":118.55865054225015,"lat":24.72963829769785,"count":83},
    {"lng":119.07773096395962,"lat":25.448450136734262,"count":0},
    {"lng":118.60036234322938,"lat":24.901652383991102,"count":88},
    {"lng":118.18188294866125,"lat":26.643626474197838,"count":1},
    {"lng":119.54208214971854,"lat":26.656527419158913,"count":0},
    {"lng":117.64219393404412,"lat":26.270835279362192,"count":0},
    {"lng":103.8233054407292,"lat":36.06422552504259,"count":92},
    {"lng":104.62663760066474,"lat":35.586056241828416,"count":0},
    {"lng":106.68891115654719,"lat":35.550110190016646,"count":0},
    {"lng":103.20057576109534,"lat":35.585834814564286,"count":0},
    {"lng":98.50841450616744,"lat":39.74147376815896,"count":87},
    {"lng":100.45989186892419,"lat":38.93932029698206,"count":0},
    {"lng":107.6442270867326,"lat":35.72680075452996,"count":0},
    {"lng":102.64014734336779,"lat":37.933172142905626,"count":2},
    {"lng":113.30764967515182,"lat":23.12004910207623,"count":34},
    {"lng":114.0259736573215,"lat":22.546053546205247,"count":87},
    {"lng":113.56244702618993,"lat":22.25691464612574,"count":19},
    {"lng":113.76343399075655,"lat":23.043023815368237,"count":43},
    {"lng":121.67796628922625,"lat":38.900436431991984,"count":22},
    {"lng":116.72865028834109,"lat":23.383908453269196,"count":85},
    {"lng":116.63007599086392,"lat":23.661811676516503,"count":0},
    {"lng":113.5944611074356,"lat":24.80296031189189,"count":1},
    {"lng":110.36506726285033,"lat":21.257463103764316,"count":84},
    {"lng":112.4796533699162,"lat":23.078663282928925,"count":0},
    {"lng":110.93124533067585,"lat":21.66822571882161,"count":83},
    {"lng":116.12640309836864,"lat":24.30457060603053,"count":83},
    {"lng":113.1340256353934,"lat":23.035094840514382,"count":42},
    {"lng":118.25784790074829,"lat":39.69212342084615,"count":0},
    {"lng":114.41065807997101,"lat":23.11353985240842,"count":19},
    {"lng":113.07812534115365,"lat":22.57511678345104,"count":18},
    {"lng":116.37950085538243,"lat":23.547999466926136,"count":18},
    {"lng":113.04077334890835,"lat":23.698468550422163,"count":84},
    {"lng":111.97700975587391,"lat":21.87151730451877,"count":0},
    {"lng":114.71372147587483,"lat":23.757250850469006,"count":83},
    {"lng":115.3729242893998,"lat":22.77873050016389,"count":0},
    {"lng":108.29723355586638,"lat":22.80649293560261,"count":99},
    {"lng":109.42240181015114,"lat":24.329053352467223,"count":92},
    {"lng":110.26092014748276,"lat":25.262901245955238,"count":87},
    {"lng":109.12262791919323,"lat":21.472718235009687,"count":83},
    {"lng":106.63182140365117,"lat":23.901512367910115,"count":0},
    {"lng":111.5525941788367,"lat":24.41105354711281,"count":1},
    {"lng":108.06994770936778,"lat":24.699520782873197,"count":0},
    {"lng":109.61370755657885,"lat":23.10337316440881,"count":0},
    {"lng":110.15167631614493,"lat":22.643973608377276,"count":90},
    {"lng":108.6387980564235,"lat":21.973350465312727,"count":0},
    {"lng":111.30547195007331,"lat":23.485394636734455,"count":0},
    {"lng":109.23181650474223,"lat":23.741165926514817,"count":0},
    {"lng":106.7091770961758,"lat":26.62990674144093,"count":78},
    {"lng":106.93126031648453,"lat":27.699961377076246,"count":83},
    {"lng":104.85783724276915,"lat":25.002543765436346,"count":83},
    {"lng":105.92826996575766,"lat":26.228594577737493,"count":0},
    {"lng":107.47755892677523,"lat":26.153657135480728,"count":0},
    {"lng":107.94823859488538,"lat":26.6317423326968,"count":0},
    {"lng":109.16855802826001,"lat":27.674902690624183,"count":0},
    {"lng":110.3308018483363,"lat":20.022071276952243,"count":19},
    {"lng":109.52277128135884,"lat":18.257775914897483,"count":1},
    {"lng":114.52208184420766,"lat":38.048958314615454,"count":33},
    {"lng":118.18345059773411,"lat":39.6505309225366,"count":27},
    {"lng":114.52048681294414,"lat":37.069531196911996,"count":19},
    {"lng":116.16321405193285,"lat":38.741104641109665,"count":0},
    {"lng":119.6043676161184,"lat":39.945461565897574,"count":11},
    {"lng":116.70360222263986,"lat":39.51861062508462,"count":12},
    {"lng":114.4826939323422,"lat":36.60930792847117,"count":21},
    {"lng":115.68622865290865,"lat":37.74692904585666,"count":18},
    {"lng":116.86380647644208,"lat":38.297615350325714,"count":13},
    {"lng":115.49481016907626,"lat":38.88656454802744,"count":9},
    {"lng":114.89378153032918,"lat":40.81118849110306,"count":7},
    {"lng":117.93382245583847,"lat":40.992521052457136,"count":23},
    {"lng":113.64964384986449,"lat":34.756610064140254,"count":22},
    {"lng":112.44752476895121,"lat":34.65736781765111,"count":83},
    {"lng":114.0854909934702,"lat":32.128582307511664,"count":83},
    {"lng":113.91269016082377,"lat":35.3072575576613,"count":85},
    {"lng":115.64188568785016,"lat":34.43858864024636,"count":83},
    {"lng":115.02662744067226,"lat":35.75329788820758,"count":83},
    {"lng":112.5428419005123,"lat":33.0114195691165,"count":0},
    {"lng":114.04606140022909,"lat":33.57627868848315,"count":0},
    {"lng":114.35180650767198,"lat":36.1102667221811,"count":0},
    {"lng":116.32816136356094,"lat":37.46082592630501,"count":17},
    {"lng":114.29776983802476,"lat":35.75542587422399,"count":0},
    {"lng":113.30084897797529,"lat":33.74530145652439,"count":84},
    {"lng":114.04915354745555,"lat":32.98315815409348,"count":0},
    {"lng":113.8353124597886,"lat":34.026739588655204,"count":83},
    {"lng":126.65771685544611,"lat":45.7732246332393,"count":91},
    {"lng":125.02183973021087,"lat":46.596709020007594,"count":85},
    {"lng":123.9872889421725,"lat":47.34769981336638,"count":83},
    {"lng":130.28473458595482,"lat":46.813779604740354,"count":83},
    {"lng":130.94176727325066,"lat":45.32153988655108,"count":1},
    {"lng":129.608035395637,"lat":44.58852115278252,"count":86},
    {"lng":126.98909457163498,"lat":46.64606392699692,"count":0},
    {"lng":114.31620010268132,"lat":30.58108412692075,"count":96},
    {"lng":110.80122891676038,"lat":32.636994339468124,"count":84},
    {"lng":112.25009284837394,"lat":32.22916859153757,"count":84},
    {"lng":113.37935836429192,"lat":31.717857608188574,"count":0},
    {"lng":111.31098109196083,"lat":30.73275781802591,"count":86},
    {"lng":112.21733029896677,"lat":31.04261120294864,"count":1},
    {"lng":112.09985718064648,"lat":30.396103360852894,"count":84},
    {"lng":109.517432662322,"lat":30.30897851129638,"count":0},
    {"lng":113.93573439207124,"lat":30.927954784200963,"count":0},
    {"lng":112.9793527876505,"lat":28.21347823085322,"count":91},
    {"lng":111.65371813684197,"lat":29.012148855180815,"count":84},
    {"lng":112.58381881071617,"lat":26.89816441535812,"count":83},
    {"lng":109.9869587958539,"lat":27.557482901172786,"count":83},
    {"lng":113.13169534107074,"lat":27.82743292766265,"count":83},
    {"lng":113.14619551911636,"lat":29.378007075474304,"count":83},
    {"lng":111.46152540355403,"lat":27.236811244922414,"count":0},
    {"lng":111.61464768615666,"lat":26.435971646759207,"count":0},
    {"lng":112.36654664522563,"lat":28.58808777988717,"count":0},
    {"lng":125.31364242720072,"lat":43.89833760709784,"count":88},
    {"lng":126.56454398883335,"lat":43.87198833435933,"count":88},
    {"lng":125.94265013851434,"lat":41.73639712986761,"count":0},
    {"lng":129.47130153101367,"lat":43.05966660114006,"count":3},
    {"lng":126.43579767534614,"lat":41.94585939701795,"count":0},
    {"lng":124.83299453234117,"lat":45.136048970084005,"count":84},
    {"lng":118.77807440802562,"lat":32.05723550180587,"count":29},
    {"lng":120.61990711548988,"lat":31.317987367952437,"count":22},
    {"lng":120.30545590053595,"lat":31.57003745192303,"count":27},
    {"lng":120.8314859651577,"lat":31.669446047798115,"count":0},
    {"lng":119.98186101345706,"lat":31.771396744684242,"count":23},
    {"lng":120.31067896715737,"lat":31.83742542205119,"count":1},
    {"lng":120.96580778410554,"lat":31.32893679549736,"count":0},
    {"lng":119.17387221741889,"lat":34.60154896700999,"count":20},
    {"lng":120.87380095093022,"lat":32.014664540823446,"count":21},
    {"lng":120.14887181793894,"lat":33.379861877120995,"count":18},
    {"lng":119.42777755116975,"lat":32.40850525456844,"count":19},
    {"lng":120.62727852834483,"lat":31.907812337769094,"count":0},
    {"lng":119.45583540512952,"lat":32.20440944359928,"count":17},
    {"lng":119.91960601619071,"lat":32.47605327483028,"count":17},
    {"lng":117.18810662317686,"lat":34.27155343109188,"count":19},
    {"lng":118.29689337855334,"lat":33.95204973370865,"count":17},
    {"lng":119.79026529658498,"lat":31.362244911878832,"count":1},
    {"lng":120.47392692165361,"lat":32.553985066143284,"count":0},
    {"lng":119.71731808778931,"lat":32.54916027106126,"count":0},
    {"lng":115.89352754583604,"lat":28.689578000141147,"count":84},
    {"lng":117.95546387714894,"lat":28.457622553937274,"count":83},
    {"lng":114.9471174167892,"lat":27.82232155862896,"count":0},
    {"lng":114.40003867155777,"lat":27.811129895842885,"count":0},
    {"lng":115.99984802155373,"lat":29.71963952612237,"count":84},
    {"lng":114.9359090792838,"lat":25.84529553634676,"count":84},
    {"lng":114.99203871092017,"lat":27.113847650157084,"count":83},
    {"lng":124.39138207367984,"lat":43.17552470112557,"count":1},
    {"lng":123.43279092160505,"lat":41.808644783515746,"count":100},
    {"lng":123.92981976705381,"lat":41.8773038295909,"count":84},
    {"lng":121.66082212856833,"lat":42.01925010706022,"count":0},
    {"lng":120.86075764475588,"lat":40.743029881317504,"count":83},
    {"lng":116.52169489108084,"lat":39.95895316640668,"count":0},
    {"lng":121.59347778143518,"lat":38.94870993830429,"count":123},
    {"lng":121.14774873823639,"lat":41.13087887591732,"count":17},
    {"lng":123.85484961461594,"lat":42.29975701212545,"count":83},
    {"lng":111.6603505200542,"lat":40.828318873081585,"count":88},
    {"lng":109.84623853249181,"lat":40.64711942570857,"count":88},
    {"lng":118.9307611921676,"lat":42.297112320317325,"count":65},
    {"lng":122.26036326322144,"lat":43.633756072995986,"count":85},
    {"lng":106.83199909716231,"lat":39.683177006785236,"count":0},
    {"lng":109.99370625145134,"lat":39.81648956060153,"count":83},
    {"lng":119.76082179399947,"lat":49.201636054604336,"count":83},
    {"lng":122.04816651406564,"lat":46.08375706518232,"count":0},
    {"lng":106.2064786078384,"lat":38.50262101187604,"count":78},
    {"lng":106.28526799598252,"lat":36.02152348070926,"count":0},
    {"lng":106.37933720152914,"lat":39.02022328360303,"count":0},
    {"lng":101.76792098980276,"lat":36.640738611957964,"count":87},
    {"lng":92.7016667522756,"lat":35.580972291411406,"count":0},
    {"lng":117.02496706629023,"lat":36.68278472716141,"count":79},
    {"lng":120.38442818368189,"lat":36.10521490127382,"count":98},
    {"lng":121.30955503008511,"lat":37.53656156285964,"count":84},
    {"lng":122.09395836580605,"lat":37.52878708125143,"count":3},
    {"lng":119.14263382297052,"lat":36.71611487305138,"count":91},
    {"lng":117.08941491713698,"lat":36.18807775894815,"count":84},
    {"lng":117.27930538329689,"lat":34.80788307838604,"count":84},
    {"lng":118.05913427786938,"lat":36.80468485421204,"count":88},
    {"lng":118.61264305187912,"lat":37.408666288041196,"count":83},
    {"lng":115.46335977452752,"lat":35.26244049607468,"count":83},
    {"lng":117.96829241452845,"lat":37.405313941825895,"count":83},
    {"lng":115.98686913929107,"lat":36.455828514727976,"count":83},
    {"lng":118.34076823661057,"lat":35.07240907439113,"count":84},
    {"lng":116.60079762482256,"lat":35.40212166433135,"count":85},
    {"lng":119.50717994299387,"lat":35.42022519314436,"count":85},
    {"lng":117.14761619529622,"lat":35.06579087186232,"count":0},
    {"lng":119.95106201677129,"lat":36.78855004713476,"count":0},
    {"lng":112.5508635890553,"lat":37.89027705396754,"count":99},
    {"lng":124.6990773926766,"lat":46.07005100166291,"count":86},
    {"lng":112.86733275750684,"lat":35.49983446722556,"count":84},
    {"lng":112.73851439991773,"lat":37.69336152679759,"count":0},
    {"lng":111.53878759640808,"lat":36.09974544358536,"count":83},
    {"lng":113.12029208572514,"lat":36.20166438574343,"count":0},
    {"lng":111.00685365308033,"lat":35.03885947981193,"count":84},
    {"lng":113.56923760163296,"lat":37.86952949322259,"count":84},
    {"lng":112.47992772666272,"lat":39.33767196622064,"count":0},
    {"lng":125.15014857862096,"lat":42.98636494637781,"count":30},
    {"lng":109.74592574432862,"lat":38.279439240070595,"count":0},
    {"lng":107.17064545238307,"lat":34.36408080974784,"count":84},
    {"lng":107.04547762872542,"lat":33.08156897815767,"count":0},
    {"lng":109.50050975696925,"lat":36.60332035226031,"count":83},
    {"lng":121.48789948569473,"lat":31.24916171001514,"count":40},
    {"lng":104.06792346330406,"lat":30.679942845419564,"count":87},
    {"lng":104.70551897529307,"lat":31.50470125806144,"count":17},
    {"lng":105.56488779226322,"lat":30.55749135037996,"count":0},
    {"lng":101.72242315249032,"lat":26.587571257108653,"count":83},
    {"lng":102.11788786037536,"lat":27.863377395840185,"count":0},
    {"lng":104.63301906152529,"lat":28.76967479626591,"count":83},
    {"lng":104.77607133936438,"lat":29.359156889475667,"count":0},
    {"lng":105.81968693999652,"lat":32.441040158428244,"count":0},
    {"lng":104.40239781824484,"lat":31.131139652701417,"count":17},
    {"lng":103.76082423877176,"lat":29.600957611095073,"count":83},
    {"lng":106.10555398379239,"lat":30.800965168237234,"count":83},
    {"lng":103.84142956286796,"lat":30.06111507994454,"count":0},
    {"lng":105.44397028920636,"lat":28.895929803860103,"count":83},
    {"lng":107.49497344658866,"lat":31.214198858944734,"count":0},
    {"lng":106.75891196362113,"lat":30.59924998719945,"count":0},
    {"lng":117.21081309155257,"lat":39.143929903310074,"count":22},
    {"lng":87.56498774111579,"lat":43.84038034721766,"count":32},
    {"lng":85.70941760173511,"lat":41.705499905673676,"count":83},
    {"lng":93.52937301238876,"lat":42.34446710455244,"count":0},
    {"lng":81.2890480714925,"lat":44.020355819309486,"count":0},
    {"lng":86.04186492219485,"lat":44.308258980430466,"count":0},
    {"lng":102.71460113878045,"lat":25.049153100453157,"count":89},
    {"lng":102.54506789248256,"lat":24.370447134438425,"count":1},
    {"lng":100.21920895421849,"lat":25.693966622473024,"count":83},
    {"lng":121.24840817975154,"lat":30.83508077708232,"count":3},
    {"lng":104.03093981246279,"lat":23.416009535072305,"count":0},
    {"lng":120.2193754157201,"lat":30.259244461536102,"count":22},
    {"lng":121.57900597258933,"lat":29.885258965918055,"count":24},
    {"lng":120.6906347337091,"lat":28.002837594041246,"count":19},
    {"lng":120.76042769895746,"lat":30.77399223958183,"count":21},
    {"lng":119.65257570368145,"lat":29.10289910539069,"count":22},
    {"lng":120.13724316328172,"lat":30.877925155690896,"count":21},
    {"lng":121.44061293593727,"lat":28.668283285674367,"count":83},
    {"lng":120.59246738555154,"lat":30.00236458052847,"count":17},
    {"lng":106.53063501341296,"lat":29.54460610888615,"count":85},
    {"lng":107.34079973802694,"lat":29.66467054055969,"count":0},
    {"lng":105.19675419935521,"lat":37.52112419159455,"count":0},
    {"lng":117.02128418408721,"lat":39.96742764877024,"count":0},
    {"lng":108.41343863669852,"lat":30.71005418436643,"count":0},
    {"lng":109.334586198865,"lat":19.57478779859743,"count":83},
    {"lng":115.98586699622393,"lat":25.921831361760326,"count":0},
    {"lng":117.90306004275956,"lat":34.40294639487661,"count":0},
    {"lng":118.85774971753034,"lat":34.15401365959694,"count":0},
    {"lng":119.5341512146935,"lat":31.728356462124296,"count":0},
    {"lng":121.31247014367143,"lat":31.956038868177135,"count":0},
    {"lng":118.80947288339323,"lat":24.991871443314984,"count":0},
    {"lng":110.97560541085699,"lat":22.035521645118745,"count":0},
    {"lng":110.36832789757497,"lat":24.525342885431627,"count":0},
    {"lng":109.16892656266683,"lat":22.774919317685008,"count":0},
    {"lng":120.49041120216108,"lat":30.61234103032807,"count":3},
    {"lng":113.39269360871683,"lat":34.20030755802604,"count":0},
    {"lng":119.95942122689219,"lat":36.24803145848278,"count":0},
    {"lng":110.5395914683753,"lat":21.845482259109232,"count":1},
    {"lng":110.41260119285069,"lat":23.53868288368454,"count":0},
    {"lng":91.34704295954771,"lat":30.116477915324143,"count":83},
    {"lng":105.69186958244853,"lat":37.36009737510815,"count":0}];

    if(!isSupportCanvas()){
    	alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
	//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
	//参数说明如下:
	/* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *	{
			.2:'rgb(0, 255, 255)',
			.5:'rgb(0, 110, 255)',
			.8:'rgb(100, 0, 255)'
		}
		其中 key 表示插值的位置, 0~1.
		    value 为颜色值.
     */
	heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":10});
	map.addOverlay(heatmapOverlay);
	heatmapOverlay.setDataSet({data:points,max:30});
	//是否显示热力图
    function openHeatmap(){
        heatmapOverlay.show();
    }
	function closeHeatmap(){
        heatmapOverlay.hide();
    }
	closeHeatmap();
    function setGradient(){
     	/*格式如下所示:
		{
	  		0:'rgb(102, 255, 0)',
	 	 	.5:'rgb(255, 170, 0)',
		  	1:'rgb(255, 0, 0)'
		}*/
     	var gradient = {};
     	var colors = document.querySelectorAll("input[type='color']");
     	colors = [].slice.call(colors,0);
     	colors.forEach(function(ele){
			gradient[ele.getAttribute("data-key")] = ele.value;
     	});
        heatmapOverlay.setOptions({"gradient":gradient});
    }
	//判断浏览区是否支持canvas
    function isSupportCanvas(){
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>
